import{M as y}from"./bootstrap.esm-B2wRDyRU.js";import{_ as p,o as r,c as n,a as t,t as d,e as P,v,F as m,f as g,r as $,b as f,n as C,g as k,d as M}from"./index-CRT6yWqx.js";const L={props:["tempProduct","addToCart"],data(){return{userProductModal:"",qty:1}},methods:{open(){this.userProductModal.show()},close(){this.userProductModal.hide()}},watch:{tempProduct(){this.qty=1}},mounted(){this.userProductModal=new y(this.$refs.userProductModal,{keyboard:!1,backdrop:"static"})}},x={class:"modal fade",id:"userProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"userProductModal"},T={class:"modal-dialog modal-xl",role:"document"},V={class:"modal-content border-0"},w={class:"modal-header bg-dark text-white"},U={class:"modal-title",id:"exampleModalLabel"},E=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),q={class:"modal-body"},I={class:"row"},Q={class:"col-sm-6"},S=["src"],D={class:"col-sm-6"},R={class:"badge bg-primary rounded-pill"},A={key:0,class:"h5"},B={key:1,class:"h6"},N={class:"h5"},F={class:"input-group"},O=["value"];function z(e,a,s,h,i,_){return r(),n("div",x,[t("div",T,[t("div",V,[t("div",w,[t("h5",U,[t("span",null,d(s.tempProduct.title),1)]),E]),t("div",q,[t("div",I,[t("div",Q,[t("img",{class:"img-fluid",src:s.tempProduct.imagesUrl,alt:""},null,8,S)]),t("div",D,[t("span",R,d(),1),t("p",null,"商品描述："+d(s.tempProduct.description),1),t("p",null,"商品內容："+d(s.tempProduct.content),1),s.tempProduct.origin_price===s.tempProduct.price?(r(),n("div",A,d(s.tempProduct.price)+" 元",1)):(r(),n("del",B,"原價 "+d(s.tempProduct.origin_price)+" 元",1)),t("div",N,"現在只要 "+d(s.tempProduct.price)+" 元",1),t("div",null,[t("div",F,[P(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a[0]||(a[0]=c=>i.qty=c)},[(r(),n(m,null,g(20,c=>t("option",{value:c,key:c},d(c),9,O)),64))],512),[[v,i.qty]]),t("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=c=>s.addToCart(s.tempProduct.id,i.qty))},"加入購物車")])])])])])])])],512)}const H=p(L,[["render",z]]);var j={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"townyuan",BASE_URL:"/vue3-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:l,VITE_PATH:u}=j,G={data(){return{products:[],tempProduct:{},status:{addCartLoading:"",cartQtyLoading:""},userProductModal:null,qty:1,carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{UserProductModal:H},methods:{getProducts(){this.$http.get(`${l}/api/${u}/products/all`).then(e=>{this.products=e.data.products}).catch(e=>{alert(e.response.data.message)})},openModal(e){this.tempProduct=e,this.$refs.userProductModal.open()},addToCart(e,a=1){const s={product_id:e,qty:a};this.status.addCartLoading=e,this.$http.post(`${l}/api/${u}/cart`,{data:s}).then(()=>{this.status.addCartLoading="",this.getCart(),this.$refs.userProductModal.close(),alert("已加入購物車")}).catch(h=>{alert(h.response.data.message)})},getCart(){this.$http.get(`${l}/api/${u}/cart`).then(e=>{this.carts=e.data.data}).catch(e=>{alert(e.response.data.message)})},changeCartQty(e,a=1){const s={product_id:e.product_id,qty:a};this.status.cartQtyLoading=e.id,this.$http.put(`${l}/api/${u}/cart/${e.id}`,{data:s}).then(()=>{this.status.cartQtyLoading="",this.getCart()}).catch(h=>{alert(h.response.data.message)})},removeCartItem(e){this.status.cartQtyLoading=e,this.$http.delete(`${l}/api/${u}/cart/${e}`).then(()=>{this.status.cartQtyLoading="",this.getCart()}).catch(a=>{alert(a.response.data.message)})},deleteAllCarts(){this.$http.delete(`${l}/api/${u}/carts`).then(()=>{this.getCart()}).catch(e=>{alert.log(e.response.message)})},createOrder(){const e=this.form;this.$http.post(`${l}/api/${u}/order`,{data:e}).then(a=>{alert(a.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(a=>{alert(a.response.data.message)})}},mounted(){this.getProducts(),this.getCart()}},J=t("h5",{class:"my-3 text-center"},"產品列表",-1),K={class:"container"},W={class:"mt-4"},X={class:"table align-middle"},Y=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),Z={style:{width:"200px"}},tt={key:0,class:"h5"},et={key:1,class:"h6"},st={class:"h5"},at={class:"btn-group btn-group-sm"},ot=["onClick"],dt=["disabled","onClick"],rt={key:0,class:"spinner-border spinner-border-sm","aria-hidden":"true"};function nt(e,a,s,h,i,_){const c=$("UserProductModal");return r(),n(m,null,[J,t("div",K,[t("div",W,[f(c,{ref:"userProductModal","temp-product":i.tempProduct,"add-to-cart":_.addToCart},null,8,["temp-product","add-to-cart"]),t("table",X,[Y,t("tbody",null,[(r(!0),n(m,null,g(i.products,o=>(r(),n("tr",{key:o.key},[t("td",Z,[t("div",{style:C([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.imageUrl})`}])},null,4)]),t("td",null,d(o.title),1),t("td",null,[o.origin_price===o.price?(r(),n("div",tt,d(o.price)+" 元",1)):(r(),n("del",et,"原價 "+d(o.origin_price)+" 元",1)),t("div",st,"現在只要 "+d(o.price)+" 元",1)]),t("td",null,[t("div",at,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:b=>_.openModal(o)}," 查看更多 ",8,ot),t("button",{type:"button",class:"btn btn-outline-danger",disabled:o.id===i.status.addCartLoading,onClick:b=>_.addToCart(o.id)},[o.id===i.status.addCartLoading?(r(),n("span",rt)):k("",!0),M(" 加到購物車 ")],8,dt)])])]))),128))])])])])],64)}const lt=p(G,[["render",nt]]);export{lt as default};
